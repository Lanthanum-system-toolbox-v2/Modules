!module
class=cpua
!view
view=title
text=高通温控方案
@show
echo true
@show
!view
!view
view=subtitle
text=控制高通温控引擎
@show
echo true
@show
!view

!view
view=button
text=停用温控引擎
root=true
onboot=true
@click
stop thermal-engine
@click
@show
if [ `which thermal-engine` != "" ]
then
echo true
fi
@show
core=true
!view

!view
view=title
text=高通温控驱动
@show
echo true
@show
!view

!view
view=switch
text=核心控制
@current
if [ `cat /sys/module/msm_thermal/core_control/enabled` == 1 ]
then
echo true
fi
@current
@show
if [ -e /sys/module/msm_thermal/core_control/enabled ]
then
echo true
fi
@show
@click
echo $switch > /sys/module/msm_thermal/core_control/enabled
@click
core=true
root=true
!view

!view
view=switch
text=VDD限制
@current
if [ `cat /sys/module/msm_thermal/vdd_restriction/enabled` == 1 ]
then
echo true
fi
@current
@show
if [ -e /sys/module/msm_thermal/vdd_restriction/enabled ]
then
echo true
fi
@show
@click
echo $switch > /sys/module/msm_thermal/vdd_restriction/enabled
@click
core=true
root=true
!view


!view
view=switch
text=SOC温度限制门限
@current
if [ `cat /sys/module/msm_thermal/parameters/enabled` == Y ]
then
echo true
fi
@current
@show
if [ -e /sys/module/msm_thermal/parameters/enabled ]
then
echo true
fi
@show
@click
echo $switch > /sys/module/msm_thermal/parameters/enabled
@click
core=true
root=true
!view


#vendor

!view
view=title
text=高通删温控（实验性）
@show
if [ -e /vendor/bin/thermal-engine ]
then
echo true
fi
@show
root=true
!view

!view
view=subtitle
text=这可能在某些内核上造成意想不到的后果；比如可能导致内核中的备用温控方案被激活，温控更加严格 手动滑稽。\n现在，工具将不会真正移除温控二进制文件，但是我们通过玄学方法使之失效。
@show
if [ -e /vendor/bin/thermal-engine ]
then
echo true
fi
@show
root=true
!view

!view
view=switch
text=启用温控二进制文件
@show
if [ -e /vendor/bin/thermal-engine ]
then
echo true
fi
@show
root=true
core=true
@current
t=/vendor/bin/thermal-engine
if [ `stat -c%a $t` == 755 ]
then
echo true
fi
@current

@click
t=/vendor/bin/thermal-engine
mount -o rw,remount /system
mount -o rw,remount /vendor
if [ $switch == 1 ]
then
chmod 755 $t
else
chmod 0 $t
fi
mount -o ro,remount /system
mount -o ro,remount /vendor
echo @toast=建议刷新页面检查是否更改成功，一切更改将在重启后生效。
@click

!view



!module